## 密码学基础

#### 对称加解密

##### 加密三要素

- 明文：要发送的数据
- 加密算法：以什么规则加密
- 密钥：双方约定的钥匙

##### 解密三要素

- 密文：hdsildcs
- 解密算法：算法与加密算法可能相同（凯撒密码），也可能不同
- 密钥：一定与加密密钥相同

![这里写图片描述](https://img-blog.csdn.net/20180820234609737?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2dvZ29fd2Vp/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

#### 凯撒密码

通过把字母移动一定的位数来实现加密和解密。明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文。

例如，当偏移量是3的时候，所有的字母A将被替换成D，B变成E，以此类推X将变成A，Y变成B，Z变成C。

位数就是凯撒密码加密和解密的密钥。



#### 对称加密和非对称加密

- ###### 对称加密，又称私钥加密

对称加密是最快速、最简单的一种加密方式，加密与解密用的是同样的密钥，这种方法在密码学中叫做对称加密算法。

对称加密有很多种算法，由于它**效率很高**，所以被广泛使用在很多加密协议的核心当中。对称加密通常使用的是相对较小的密钥，一般小于256 bit。因为**密钥越大，加密越强，但加密与解密的过程越慢**。如果你只用1 bit来做这个密钥，那黑客们可以先试着用0来解密，不行的话就再用1解；但如果你的密钥有1 MB大，黑客们可能永远也无法破解，但加密和解密的过程要花费很长的时间。密钥的大小既要照顾到安全性，也要照顾到效率，是一个trade-off。

- ###### 非对称加密，又称公钥加密

1976年，美国学者Dime和Henman为解决信息公开传送和密钥管理问题，提出一种新的密钥交换协议，允许在不安全的媒体上的通讯双方交换信息，安全地达成一致的密钥，这就是“公开密钥系统”。相对于“对称加密算法”这种方法也叫做“非对称加密算法”。

非对称加密为数据的加密与解密提供了一个非常安全的方法，它使用了一对密钥，公钥和私钥。**私钥只能由一方安全保管**，不能外泄，而**公钥则可以发给任何请求它的人**。非对称加密使用这对密钥中的一个进行加密，而解密则需要另一个密钥。比如，你向银行请求公钥，银行将公钥发给你，你使用公钥对消息加密，那么只有私钥的持有人--银行才能对你的消息解密。与对称加密不同的是，银行不需要将私钥通过网络发送出去，因此安全性大大提高。

对称密钥加密，是信息的发送方和接收方都用同一个秘钥去加密和解密数据。它的最大优势是加/解密速度快，适合于对大数据量进行密，但密钥管理困难。

非对称密钥加密，它需要使用“一对”密钥来分别完成加密和解密操作，一个公开发布，即公开密钥，另一个由用户自己秘密保存，即私用密钥。信息发送者用公开密钥去加密，而信息接收者则用私用密钥去解密。公钥机制灵活，但加密和解密速度却比对称密钥加密慢得多。

###### 对称加密和非对称加密的区别：

（1） 对称加密加密与解密使用的是同样的密钥，所以速度快，但由于需要将密钥在网络传输，所以安全性不高。
（2） 非对称加密使用了一对密钥，公钥与私钥，所以安全性高，但加密与解密速度慢。
（3） 解决的办法是将对称加密的密钥使用非对称加密的公钥进行加密，然后发送出去，接收方使用私钥进行解密得到对称加密的密钥，然后双方可以使用对称加密来进行沟通。



##### 计算机单位换算

位：bit，0或1，最小的单位

==字节：Byte，1Byte = 8bit==

千字节：KByte，1K = 1024B， （硬盘里1K = 1000B）

兆字节：MByte，1M = 1024K = 1024B * 1024 =  1024 *  1024 * 8 bit

1 GB = 1024M = 1024K = 1024B =1024 * 8 bit

1TB = 1024GB

1PB = 1024TB



#### 对称加密算法

##### 1.DES

> DES 全称 Data Encryption Standard，是一种使用密钥加密的块算法。现在认为是一种不安全的加密算法，因为现在已经有用穷举法攻破 DES 密码的报道了。尽管如此，该加密算法还是运用非常普遍，是一种标准的加密算法，3DES 是 DES 的加强版本。
>
> DES 加密算法出自 IBM 的研究，后来被美国政府正式采用，之后开始广泛流传，但是近些年使用越来越少，因为 DES 使用**56位密钥**（密钥长度越长越安全），以现代计算能力24小时内即可被破解。虽然如此，在某些简单应用中，我们还是可以使用 DES 加密算法。

DES 算法的入口参数有三个：Key、Data、Mode。

- Key 是 DES 算法的工作密钥。
- Data 是要被加密或被解密的数据。
- Mode 为 DES 的工作方式，有两种：加密或解密。

<font color="red">从规格上来说，DES的密钥长度是64比特，但由于每隔7比特会设置一个用于错误检查的比特，因此实质上其密钥长度是56比特</font>。<font color="red">DES是以64比特的明文（比特序列）为一个单位来进行加密的</font>，**这个64比特的单位称为分组**。一般来说，以分组为单位进行处理的密码算法称为**分组密码（blockcipher）**，DES就是分组密码的一种。

秘钥：8字节（64 - 8 = 56比特）

分组：8字节（64比特）



##### 2.3DES

三重DES（triple-DES）是为了增加DES的强度，将DES重复3次所得到的一种密码算法，通常缩写为3DES。

明文经过三次DES处理才能变成最后的密文，由于**DES密钥的长度实质上是56比特**，因此<font color="red">三重DES的密钥长度就是56×3=168比特, 加上用于错误检测的标志位8x3, 共192bit</font>。当三重DES中所有的密钥都相同时，三重DES也就等同于普通的DES了。

- 如果秘钥1与秘钥2相同，或者秘钥2与秘钥3相同，这就相当于des，与前面进行兼容
- 如果秘钥1与秘钥3相同，相当于有两个秘钥，专业名字：3des-EDE2
- 如果三个秘钥都不相同，专业名字：3des-EDE3

秘钥：8 * 3 = 24 字节（24 * 8 = 192比特）

分组：8字节



##### 3.AES

AES的全称是Advanced Encryption Standard，意思是高级加密标准。它的出现主要是为了取代DES加密算法。

所有AES都必须满足以下标准：

- 分组大小为128位的分组密码。
- 必须支持三种密码标准：128位、192位和256位。
- 比提交的其他算法更安全。
- 在软件和硬件实现上都很高效。

AES密码与分组密码Rijndael基本上完全一致，Rijndael分组大小和密钥大小都可以为128位、192位和256位。然而AES只要求分组大小为128位，因此只有分组长度为128Bit的Rijndael才称为AES算法。

特点：

1. 秘钥长度：可选的，16bytes, 24bytes, 32bytes， （des：8bytes, 3des: 24bytes）
2. 分组长度：16bytes， （des合约3des:8bytes）
3. 加解密效率高，推荐使用



#### 明文分组和密文分组

**明文分组:** 是指分组密码算法中作为加密对象的明文。明文分组的长度与分组密码算法的分组长度是相等的。
**密文分组:** 是指使用分组密码算法将明文分组加密之后所生成的密文。

ECB模式：Electronic Code Book mode（电子密码本模式）
CBC模式：Cipher Block Chaining mode（密码分组链接模式）
CFB模式：Cipher FeedBack mode（密文反馈模式）
OFB模式：Output FeedBack mode（输出反馈模式）
CTR模式：CounTeR mode（计数器模式）

##### 1. ECB 模式

> ECB(Electronic Code Book, 电子密码本)模式是最简单的加密模式，<font color="red">明文消息被分成固定大小的块（分组），并且每个块被单独加密。</font>  每个块的加密和解密都是独立的，且使用相同的方法进行加密，所以可以进行并行计算，但是这种方法一旦有一个块被破解，使用相同的方法可以解密所有的明文数据，
>
> 特点：<font color="red">安全性比较差。  适用于数据较少的情形，加密前需要把明文数据填充到块大小的整倍数。</font>

![ECB模式加密](https://img-blog.csdnimg.cn/20201207004126529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0F0bGFuU0k=,size_16,color_FFFFFF,t_70)

- 加密效率高，但是不安全，加密不彻底
- 需要对数据进行分组后做数据填充
- 每一个分组独立的进行加解密
- 只要有一个分组被破解，所有的分组都被破解
- 不用使用，go语言没有支持这种分组模式
- 分组长度由加密算法决定（des：8bytes, aes: 16bytes）

##### CBC模式（先异或再加密）

> CBC(Cipher Block Chaining, 密文分组链接)<font color="red">模式中每一个分组要先和前一个分组加密后的数据进行XOR异或操作，然后再进行加密</font>。  这样每个密文块依赖该块之前的所有明文块，为了保持每条消息都具有唯一性，<font color="red">第一个数据块进行加密之前需要用初始化向量IV进行异或操作</font>。  CBC模式是一种最常用的加密模式，它主要缺点是加密是连续的，不能并行处理，并且与ECB一样消息块必须填充到块大小的整倍数。

![CBC模式加密](https://img-blog.csdnimg.cn/20201207163217512.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0F0bGFuU0k=,size_16,color_FFFFFF,t_70)

- 数据分组长度根据算法而定
- 需要提供初始化向量（Initialize Vector），要求长度必须与分组长度相同
- 每一个密文都是下一次加密操作的输入
- 不能够并行加密，可以并行解密
- 加密强度高
- 如果数据切割后长度不满足需求，需要对数据进行填充。

##### 3. CFB 模式（先加密再异或）

> CFB模式的全称是Cipher FeedBack模式（密文反馈模式）。在CFB模式中，<font color="red">前一个分组的密文加密后和当前分组的明文XOR异或操作生成当前分组的密文</font>。

![CFB模式加密](https://img-blog.csdnimg.cn/2020120716554489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0F0bGFuU0k=,size_16,color_FFFFFF,t_70)

- 分组长度取决于加密算法。
- 需要初始化向量，长度必须与明文分组相同。
- 先对密文进行加密，然后再与明文分组进行异或。（CBC是先异或，再加密）
- ==由于没有直接对明文分组进行加密，所以不需要填充==

- 注意，解密的时候，是对初始向量进行加密操作，这样才能得到同样的数据

##### 4. OFB 模式

> OFB式的全称是Output-Feedback模式（输出反馈模式）。在OFB模式中，密码算法的输出会反馈到密码算法的输入中， 即上一个分组密码算法的输出是当前分组密码算法的输入。
>
> OFB模式并不是通过密码算法对明文直接进行加密的，而是通过将 “明文分组" 和 “密码算法的输出” 进行XOR来产生 “密文分组” 的，在这一点上OFB模式和CFB模式非常相似。

![OFB加密](https://img-blog.csdnimg.cn/20201207170100180.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0F0bGFuU0k=,size_16,color_FFFFFF,t_70)

- 分组长度取决于加密算法
- 不断对初始向量的输出进行加密，从而得到数据来源
- 不需要进行数据填充

##### 5. CTR 模式

> CTR模式的全称是CounTeR模式（计数器模式）。<font color="red">CTR摸式是一种通过将逐次累加的计数器进行加密来生成密钥流的流密码</font>。
>
> CTR模式中，每个分组对应一个逐次累加的计数器，并通过对计数器进行加密来生成密钥流。也就是说，最终的密文分组是通过将计数器加密得到的比特序列，与明文分组进行XOR而得到的。

![CTR加密](https://img-blog.csdnimg.cn/20201207170446800.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0F0bGFuU0k=,size_16,color_FFFFFF,t_70)

- 分组长度取决于加密算法
- 不需要填充
- 可以并行加密和并行解密，效率高，推荐使用

![总结](https://img-blog.csdnimg.cn/20201207002129916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0F0bGFuU0k=,size_16,color_FFFFFF,t_70)

